# Apache Superset Translations

This directory contains internationalization (i18n) and localization (l10n) files for Apache Superset.

## Directory Structure

Each language has its own subdirectory named after its language code (e.g., `ru` for Russian, `fr` for French):

```
translations/
├── ru/                    # Russian translations
│   └── LC_MESSAGES/
│       ├── messages.po    # Source translation file (version controlled)
│       ├── messages.mo    # Compiled backend file (generated, not in git)
│       └── messages.json  # Frontend translation file (generated, not in git)
├── fr/                    # French translations
├── es/                    # Spanish translations
└── ...                    # Other supported languages
```

## File Types

### `.po` files (Portable Object)
- Human-readable translation source files
- **Version controlled** - these files are committed to git
- Edit these files to add or update translations
- Format: Standard gettext `.po` format

### `.mo` files (Machine Object)
- Compiled binary files used by the Python/Flask backend
- **Not version controlled** - automatically generated from `.po` files
- Generated by running: `flask fab babel-compile --target superset/translations`

### `.json` files
- JSON translation files used by the React/JavaScript frontend
- **Not version controlled** - automatically generated from `.po` files
- Generated by running: `npm run build-translation` in `superset-frontend/`

## Quick Guide

### For Translators

To add or update translations:

1. Edit the appropriate `.po` file for your language (e.g., `ru/LC_MESSAGES/messages.po`)
2. Find entries with `msgid` (English text) and update the `msgstr` (translated text)
3. Compile the translations (see below)
4. Commit only the `.po` file changes to git

### Compiling Translations

After editing `.po` files, compile them to generate `.mo` and `.json` files:

```bash
# Backend translations (.mo files)
flask fab babel-compile --target superset/translations

# Or use the helper script
./scripts/translations/generate_mo_files.sh

# Frontend translations (.json files)
cd superset-frontend
npm run build-translation

# Or use the helper script
./superset-frontend/scripts/po2json.sh
```

### Extracting New Strings

When code changes introduce new translatable strings:

```bash
# Extract all strings from code and update .po files
./scripts/translations/babel_update.sh
```

This will:
- Extract strings from Python code (using gettext functions: `_()`, `__()`, `lazy_gettext()`)
- Extract strings from JavaScript code (using translation functions: `t()`, `tn()`)
- Update `messages.pot` template
- Update all language `.po` files with new strings to translate

## Docker Builds

**Important**: By default, Docker builds do NOT compile translation files to reduce build time.

To enable translations in Docker builds:

```bash
# Set BUILD_TRANSLATIONS=true when building
BUILD_TRANSLATIONS=true docker-compose build

# Or use docker build directly
docker build --build-arg BUILD_TRANSLATIONS=true -t superset .
```

Without this, non-English languages will appear incomplete in the UI.

## Configuration Files

- `babel.cfg` - Babel extraction configuration (defines which files to scan for translatable strings)
- `messages.pot` - Translation template file (generated, contains all translatable strings)
- `utils.py` - Python utilities for translation management
- `empty_language_pack.json` - Empty template for new language packs

## Supported Languages

Current translations are available for:
- Arabic (ar)
- Catalan (ca)
- German (de)
- English (en) - source language
- Spanish (es)
- Persian (fa)
- French (fr)
- Italian (it)
- Japanese (ja)
- Korean (ko)
- Dutch (nl)
- Polish (pl)
- Portuguese (pt)
- Brazilian Portuguese (pt_BR)
- Russian (ru)
- Slovak (sk)
- Slovenian (sl)
- Turkish (tr)
- Ukrainian (uk)
- Chinese Simplified (zh)
- Chinese Traditional (zh_TW)

## Documentation

For complete documentation on translations, see:
- [Translations Guide](../../docs/docs/contributing/translations.mdx)

## Contributing

Contributions to improve translations are welcome! Please:

1. Only commit `.po` file changes
2. Test your translations locally before submitting
3. Follow the existing translation style and conventions
4. Ensure translations are culturally appropriate and accurate

## Technical Details

**Backend**: Flask-Babel + gettext
- Python i18n framework
- Uses compiled `.mo` files at runtime

**Frontend**: react-intl
- JavaScript i18n framework
- Uses `.json` files (JED 1.x format) at runtime

Both systems read from the same `.po` source files, ensuring consistency across backend and frontend translations.
